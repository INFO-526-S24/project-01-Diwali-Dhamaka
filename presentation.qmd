---
title: "Project title"
subtitle: "INFO 526 - Fall 2023 - Project 1"
author: "Author names"
title-slide-attributes:
  data-background-image: images/watercolour_sys02_img34_teacup-ocean.jpg
  data-background-size: stretch
  data-background-opacity: "0.7"
  data-slide-number: none
format:
  revealjs:
    theme:  ['data/customtheming.scss']
  
editor: visual
execute:
  echo: false
---

```{r}
#| label: load-packages
#| include: false

# Load packages here
pacman::p_load(dplyr,
               broom,
               ggplot2)
               # tidymodels,
               # tidyverse)

```

```{r}
#| label: setup
#| include: false

# Plot theme
ggplot2::theme_set(ggplot2::theme_minimal(base_size = 11))

# For better figure resolution
knitr::opts_chunk$set(
  fig.retina = 3, 
  dpi = 300, 
  fig.width = 6, 
  fig.asp = 0.618 
  )
```

## Introduction

## Plot 1

```{r}
#| label: question1-data-wrangling
#| warning: false
# Read in project data
diwali <- read.csv("data/diwali_sales_data.csv")

# Remove NA values
diwali <- diwali[-which(is.na(diwali$Amount)),]

# Recode marital status in case age value is illegal
diwali <- diwali |>
  mutate(
    Marital_Status = case_when(
      Age.Group == "0-17" ~ 0,
      Age < 21 & Gender =="M" ~ 0,
      TRUE ~ Marital_Status
    )
  )

# Modify dataset according to project analysis
diwali <- diwali |>
  mutate(
    # Refactorizes the product category based on similarity between products
    Product_Category = case_when(
      Product_Category %in% c("Footwear & Shoes") ~ "Clothing",
      Product_Category %in% c("Clothing & Apparel") ~ "Clothing",
      Product_Category %in% c("Books") ~ "Entertainment",
      Product_Category %in% c("Electronics & Gadgets") ~ "Entertainment",
      Product_Category %in% c("Games & Toys") ~ "Entertainment",
      Product_Category %in% c("Sports Products") ~ "Entertainment",
      Product_Category %in% c("Decor") ~ "Home",
      Product_Category %in% c("Furniture") ~ "Home",
      Product_Category %in% c("Hand & Power Tools") ~ "Home",
      Product_Category %in% c("Household items") ~ "Home",
      Product_Category %in% c("Tupperware") ~ "Home",
      Product_Category %in% c("Stationery") ~ "Office",
      Product_Category %in% c("Veterinary") ~ "Pet Care",
      TRUE ~ Product_Category
      ),
    
    # Refactorizes the marital status to detail the meaning
    Marital_Status = case_when(
      Marital_Status %in% 1 ~ "Married",
      Marital_Status %in% 0 ~ "Single"
    )
  )

# Check the number of product categories for refactor level
category_order <- as.data.frame(matrix(nrow = 8, ncol = 2))
category_order[,1] <- c("Auto", "Beauty", "Clothing", "Entertainment", "Food",
                    "Home", "Office", "Pet Care")
category_order[,2] <- as.integer(summary(as.factor(diwali$Product_Category)))
category_vector <- (category_order[order(category_order[,2]),1])

# Refactorizes the product category to sort the groups alphabetically
diwali$Product_Category <- as.factor(diwali$Product_Category)
diwali$Product_Category <- factor(diwali$Product_Category,
                                  levels = category_vector)

# Sort Gender factor level
diwali$Gender <- factor(diwali$Gender, levels = c("M", "F"))

# Sort Marital_Status factor level
diwali$Marital_Status <- factor(diwali$Marital_Status,
                                levels = c("Single", "Married"))
```

```{r} 
#| label: question1-plot
#| warning: false
#| fig-width: 10

# Bar plot showing the number of customers for product category across gender
# and marital status
ggplot(data = diwali, aes(y = Product_Category, fill = Gender)) +
  geom_bar(position = "dodge", width = 0.7) +
  scale_fill_manual(values = c("lightblue", "pink")) +
  # Reorder legend to match the order of the bar plot
  guides(fill = guide_legend(reverse = TRUE)) +
  ggtitle("Total Count of Sale Type") +
  facet_wrap(~Marital_Status, ncol = 1) +
  ylab("Product Category") +
  xlab("Counts") +
  theme(axis.text.y = element_text(size = 6))
```

## Interpretation

## Plot 2

```{r}
#| label: question2-data-wrangling
#| echo: false
# Modify data for Q2
df.Q2 <- diwali |>
  group_by(User_ID, Age) |>
  summarize(
    "Gender" = first(Gender),
    "Age_Group" = first(Age.Group),
    "Marital_Status" = first(Marital_Status),
    "Total" = sum(Amount))
```

```{r}
#| label: question2-plot
#| echo: false
# Plot Q2 data
ggplot(data = df.Q2, aes(x = Age, y = Total, color = Gender)) +
  geom_smooth()  +
  facet_wrap(~Marital_Status, ncol = 2)
```

## Validation
```{r}
#| label: question2-val
#| echo: false
diwali_lm <- lm(Total~Age, data = df.Q2)
print(tidy_diwali <- tidy(diwali_lm))
```

## Interpretation

# Using Quarto for presentations

## Quarto

-   The presentation is created using the Quarto CLI

-   `##` sets the start of a new slide

## Layouts

You can use plain text

::: columns
::: {.column width="40%"}
-   or bullet points[^1]
:::

::: {.column width="60%"}
or in two columns
:::
:::

[^1]: And add footnotes

-   like

-   this

## Code

```{r, echo=FALSE}


```

## Plots

```{r}

```

## Plot and text

::: columns
::: {.column width="50%"}
-   Some text

-   goes here
:::

::: {.column width="50%"}

```{r, warning=FALSE, fig.width=5.5}

```
:::
:::

# A new section...

## Tables

If you want to generate a table, make sure it is in the HTML format (instead of Markdown or other formats), e.g.,

```{r}

```

## Images

![Image credit: Danielle Navarro, Percolate.](images/watercolour_sys02_img34_teacup-ocean.png){fig-align="center" width="500"}

## Math Expressions {.smaller}

You can write LaTeX math expressions inside a pair of dollar signs, e.g.Â \$\\alpha+\\beta\$ renders $\alpha + \beta$. You can use the display style with double dollar signs:

```         
$$\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i$$
```

$$
\bar{X}=\frac{1}{n}\sum_{i=1}^nX_i
$$

Limitations:

1.  The source code of a LaTeX math expression must be in one line, unless it is inside a pair of double dollar signs, in which case the starting `$$` must appear in the very beginning of a line, followed immediately by a non-space character, and the ending `$$` must be at the end of a line, led by a non-space character;

2.  There should not be spaces after the opening `$` or before the closing `$`.

# Wrap up

## Feeling adventurous?

-   You are welcomed to use the default styling of the slides. In fact, that's what I expect majority of you will do. You will differentiate yourself with the content of your presentation.

-   But some of you might want to play around with slide styling. Some solutions for this can be found at https://quarto.org/docs/presentations/revealjs.
